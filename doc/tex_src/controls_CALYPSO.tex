\section{Definition of parameters for control files}
\label{section:def_control}

\subsection{Block {\tt data\_files\_def}}
\label{href_t:data_files_def}
File names and number of processes and threads are defined in this block. \\
\hyperref[href_i:MHD_control]{(Back to {\tt control\_MHD})} \\
\hyperref[href_i:spherical_shell_ctl]{(Back to {\tt control\_sph\_shell})} \\
\hyperref[href_i:assemble_control]{(Back to {\tt control\_assemble\_sph})}

\paragraph{\tt num\_subdomain\_ctl}
\label{href_t:num_subdomain_ctl}
\verb|[Num_PE]| \\
Number of subdomain for the MPI program \verb|[Num_PE]| is defined by integer. If number of processes in \verb| mpirun -np | is different from number of subdomains, program will be stopped with message.

\paragraph{\tt num\_smp\_ctl}
\label{href_t:num_smp_ctl}
\verb|[Num_Threads]| \\
Number of SMP threads for OpenMP \verb|[Num_Threads]| is defined by integer. You can set larger number than the actual umber of thread to be used. If actual number of thread is less than this number, number of threads is set to the number which is defined in this field.

\paragraph{\tt sph\_file\_prefix}
\label{href_t:sph_file_prefix}
\verb|[sph_prefix]| \\
File prefix of spherical harmonics indexing and FEM mesh file \verb|[sph_prefix]| is defined by text. Process ID and extension are added after this file prefix.

\paragraph{\tt mesh\_file\_prefix}
\label{href_t:mesh_file_prefix}
\verb|[mesh_prefix]| \\
File prefix of FEM mesh file \verb|[mesh_prefix]| is defined by text. Process ID and extension are added after this file prefix. This flag is only used for the sectioning program (\hyperref[sec:sectioning]{\tt sectioning}) and data converter to VTK (\hyperref[sec:field_to_VTK]{\tt field\_to\_VTK}).

\paragraph{\tt boundary\_data\_file\_name}
\label{href_t:boundary_data_file_name}
\verb|[boundary_data_name]| \\
File name of boundary condition data file \verb|[File_Name]| is defined by text. 

\paragraph{\tt radial\_field\_file\_name}
\label{href_t:radial_field_file_name}
\verb|[radial_field_file_name]| \\
File name of radial field data file \verb|[File_Name]| is defined by text. 

\paragraph{\tt restart\_file\_prefix}
\label{href_t:restart_file_prefix}
\verb|[rst_prefix]| \\
File prefix of spectrum data for restarting and snapshots \verb|[rst_prefix]| is defined by text. Step number, process ID, and extension are added after this file prefix.

\paragraph{\tt field\_file\_prefix}
\label{href_t:field_file_prefix}
\verb|[fld_prefix]| \\
File prefix of field data for visualize snapshots \verb|[fld_prefix]| is defined by text. Step number and file extension are  added after this file prefix.

\paragraph{\tt sph\_file\_fmt\_ctl}
\label{href_t:sph_file_fmt_ctl}
\verb|[sph_formayt]| \\
File format of spherical harmonics indexing and FEM mesh file \verb|[sph_format]| is defined by text. Following data formats can be defined. Extensions of each data format is listed in Table \ref{table:mesh_format}.
%
\begin{description}
\item{\tt ascii: }   Distributed ASCII data
\item{\tt binary: }  Distributed binary data
\item{\tt merged: }  Merged ASCII data
\item{\tt merged\_bin: }   Merged binary data
\item{\tt gzip: }            Compressed distributed ASCII data
\item{\tt binary\_gz: }      Compressed distributed binary data
\item{\tt merged\_gz: }      Compressed merged ASCII data
\item{\tt merged\_bin\_gz: } Compressed merged binary data
\end{description}
%

\paragraph{\tt mesh\_file\_fmt\_ctl}
\label{href_t:mesh_file_fmt_ctl}
\verb|[mesh_formayt]| \\
File format of FEM mesh file \verb|[mesh_format]| is defined by text. Data formats can be defined the same as {\tt sph\_file\_fmt\_ctl}. Extensions of each data format is listed in Table \ref{table:mesh_format}. This flag is only used for the sectioning program (\hyperref[sec:sectioning]{\tt sectioning}) and data converter to VTK (\hyperref[sec:field_to_VTK]{\tt field\_to\_VTK}).

\paragraph{\tt restart\_file\_fmt\_ctl}
\label{href_t:restart_file_fmt_ctl}
\verb|[rst_format]| \\
File format of restart files \verb|[rst_format]| is defined by text. Following data formats can be defined. Extensions of each data format is listed in Table \ref{table:restart_format}.
%
\begin{description}
\item{\tt ascii: }   Distributed ASCII data
\item{\tt binary: }  Distributed binary data
\item{\tt merged: }  Merged ASCII data
\item{\tt merged\_bin: }   Merged binary data
\item{\tt gzip: }            Compressed distributed ASCII data
\item{\tt binary\_gz: }      Compressed distributed binary data
\item{\tt merged\_gz: }      Compressed merged ASCII data
\item{\tt merged\_bin\_gz: } Compressed merged binary data
\end{description}
%

\paragraph{\tt field\_file\_fmt\_ctl}
\label{href_t:field_file_fmt_ctl}
\verb|[fld_format]| \\
Field data field format for visualize snapshots \verb|[fld_format]| is defined by text. The following formats are currently supported.
%
\begin{description}
\item{\tt single\_HDF5: }  Merged HDF5 file (Available if HDF5 library is linked)
\item{\tt single\_VTK: }   Merged VTK file (Default)
\item{\tt VTK: }           Distributed VTK file
\item{\tt single\_VTK\_gz: }   Compressed merged VTK file (Available if zlib library is linked)
\item{\tt VTK\_gz: }           Compressed distributed VTK file (Available if zlib library is linked)
\end{description}
%
%
%
%

\subsection{\tt spherical\_shell\_ctl}
\label{href_t:spherical_shell_ctl}
Configuration of the spherical shell and parallelization are defined by in this block. This block can be stored in an external file.
%

\subsubsection{\tt FEM\_mesh\_ctl}
\label{href_t:FEM_mesh_ctl}
Configuration of the FEM mesh is defined in this block. This block is optional.
\hyperref[href_i:FEM_mesh_ctl]{(Back to {\tt control\_sph\_shell})}

\paragraph{\tt FEM\_mesh\_output\_switch}
\label{href_t:FEM_mesh_output_switch}
\verb|[ON or OFF]| \\
Set \verb|ON| if FEM mesh data need to be written.
%

\subsubsection{\tt num\_domain\_ctl}
\label{href_t:num_domain_ctl}
Parallelization is defined in this block. Domain decomposition is defined for spectrum data, field data, and Legendre transform. \\
\hyperref[href_i:num_domain_ctl]{(Back to {\tt control\_sph\_shell})}

\paragraph{\tt ordering\_set\_ctl}
\label{href_t:ordering_set_ctl}
\verb|[ORDERING_SET]| \\
 Ordering set of spherical harmonics and grid data is defined here.  The following text parameter set \verb|[ORDERING_SET]| is available:
 \begin{description}
 \item[{\tt Ver\_2}]  Optimized ordering for Ver. 2.
 \item[{\tt Ver\_1}] Original data ordering for Ver. 1.x
 \end{description} 

If \verb|[ORDERING_SET]| is not defined, ordering set for \verb|Ver_2| is chosen.

\paragraph{\tt num\_radial\_domain\_ctl}
\label{href_t:num_radial_domain_ctl}
\verb|[Ndomain]| \\
Number of subdomains in the radial direction for the spherical grid $(r, \theta, \phi)$ and spherical transforms $(r, \theta, m)$ and $(r, l, m)$.

\paragraph{\tt num\_horizontal\_domain\_ctl}
\label{href_t:num_horizontal_domain_ctl} 
\verb|[Ndomain]| \\
Number of subdomains in the horizontal direction. The number will be the number of subdomains for the meridional directios for the spherical grid $(r, \theta, \phi)$ and Fourier transform $(r, \theta, m)$. For Legendre transform $(r, \theta, m)$ and $(r, l, m)$, the number will be the number of subdomains for the h.armonics ordedr $m$.


\paragraph{\color{magenta} \tt num\_domain\_sph\_grid    [Direction]    [Ndomain]}
\label{href_t:num_domain_sph_grid} 
{\color{magenta} (Depricated)}\\
 Definition of number of subdomains for physical data in spherical coordinate $(r, \theta, \phi)$. Direction {\tt  radial} or {\tt meridional} is set in \verb|[Direction]|, and number of subdomains \verb|[Ndomain]| are defined in the integer field.

\paragraph{\color{magenta} \tt num\_domain\_legendre    [Direction]    [Ndomain]}
\label{href_t:num_domain_legendre}
{\color{magenta} (Depricated)}\\
 Definition of number of subdomains for Legendre transform between $(r, \theta, m)$ and $(r, l, m)$. Direction {\tt  radial} or {\tt zonal} is set in \verb|[Direction]|, and number of subdomains \verb|[Ndomain]| are defined in the integer field.

\paragraph{\color{magenta} \tt num\_domain\_spectr    [Direction]    [Ndomain]}
\label{href_t:num_domain_spectr}
{\color{magenta} (Depricated)}\\
Definition of number of subdomains for spectrum data in $(r, l, m)$. Direction {\tt  modes} is set in the \verb|[Direction]| field, and number of subdomains \verb|[Ndomain]| are defined in the integer field.


\subsubsection{\tt num\_grid\_sph}
\label{href_t:num_grid_sph}
Spatial resolution of the spherical shell is defined in this block. \\
\hyperref[href_i:num_grid_sph]{(Back to {\tt control\_sph\_shell})}

\paragraph{\tt truncation\_level\_ctl}
\label{href_t:truncation_level_ctl}
\verb|[Lmax]| \\
Truncation level $L$ is defined by integer. Spherical harmonics is truncated by triangular $0 \le l \le L$ and $0 <m < l$.

\paragraph{\tt ngrid\_meridonal\_ctl}
\label{href_t:ngrid_meridonal_ctl}
\verb|[Ntheta]| \\
Number of grid in the meridional direction \verb|[Ntheta]| is defined by integer
\paragraph{\tt ngrid\_zonal\_ctl}
\label{href_t:ngrid_zonal_ctl}
\verb|[Nphi]| \\
Number of grid in the zonal direction \verb|[Nphi]| is defined by integer.

\paragraph{\tt raidal\_grid\_type\_ctl}
\label{href_t:radial_grid_type_ctl}
\verb|[explicit, Chebyshev, or equi_distance]| \\
Type of the radial grid spacing is defined by text. The following types are supported in Calypso.
%
\begin{description}
	\item{\tt explicit}  Equi-distance grid
	\item{\tt Chebyshev} Chebyshev collocation points
	\item{\tt equi\_distance} Set explicitly by \verb|r_layer| array
\end{description}
%

\paragraph{\tt num\_fluid\_grid\_ctl}
\label{href_t:num_fluid_grid_ctl}
\verb|[Nr_shell]| \\
(This option works with \verb|radial_grid_type_ctl| is {\tt explicit} or {\tt Chebyshev}.)
Number of layer in the fluid shell \verb|[Nr_shell]| is defined by integer. Number of grids including CMB and ICB will be (\verb|[Nr_shell]| + 1).

\paragraph{\tt fluid\_core\_size\_ctl}
\label{href_t:fluid_core_size_ctl}
\verb|[Length]| \\
(This option works with \verb|radial_grid_type_ctl| is {\tt explicit} or {\tt Chebyshev}.)
Size of the outer core \verb|[Length]| ($ = r_{o}-r_{i}$) is defined by real.

\paragraph{\tt ICB\_to\_CMB\_ratio\_ctl}
\label{href_t:ICB_to_CMB_ratio_ctl} 
\verb|[R_ratio]| \\
(This option works with \verb|radial_grid_type_ctl| is {\tt explicit} or {\tt Chebyshev}.)
Ratio of the inner core radius to outer core \verb|[R_ratio]| ($ = r_{i} / r_{o}$) is defined by real.

\paragraph{\tt Min\_radius\_ctl}
\label{href_t:Min_radius_ctl}
\verb|[Rmin]| \\
(This option works with \verb|radial_grid_type_ctl| is {\tt explicit} or {\tt Chebyshev}.)
Minimum radius of the domains \verb|[Rmin]| is defined by real. If this value is not defined, ICB becomes inner boundary of the domain.

\paragraph{\tt Max\_radius\_ctl }
\label{href_t:Max_radius_ctl} 
\verb|[Rmax]| \\
(This option works with \verb|radial_grid_type_ctl| is {\tt explicit} or {\tt Chebyshev}.)
Maximum radius of the domains \verb|[Rmax]| is defined by real. If this value is not defined, CMB becomes outer boundary of the domain.

\paragraph{\tt r\_layer}
\label{href_t:r_layer}
\verb|[Layer #]   [Radius]| \\
(This option works with \verb|[radial_grid_type_ctl]| is {\tt explicit}.)
List of the radial grid points in the simulation domain. Index of the radial point \verb|[Layer #]| is defined by integer, and radius \verb|[Radius]| is defined by real.

\paragraph{\tt array boundaries\_ctl}
\verb|[Boundary_name]  [Layer #]| \\
\label{href_t:boundaries_ctl} 
(This option works with \verb|[radial_grid_type_ctl]| is {\tt explicit}.)
Boundaries of the simulation domain is defined by \verb|[Layer #]| in \verb|[r_layer]| array. The following boundary name can be defined for \verb|[Boundary_name]|.
%
\begin{description}
	\item{\tt to\_Center} Inner boundary of the domain to fill the center.
	\item{\tt ICB} ICB
	\item{\tt CMB} CMB
\end{description}
%
%
%

\subsection{\tt phys\_values\_ctl}
\label{href_t:phys_values_ctl}
Fields for the simulation are defined in this block. \\
\hyperref[href_i:phys_values_ctl]{(Back to {\tt control\_MHD})}
%
\paragraph{\tt array nod\_value\_ctl}
\label{href_t:nod_value_ctl}
\verb|[Field] [Viz_flag] [Monitor_flag]| \\
Fields name \verb|[Field]| for the simulation are listed in this array. If required fields for simulation are not in the list, simulation program adds required field in the list, but does not output any field data and monitoring data. \verb|[Viz_flag]| is set to output of the field data for visualization by
%
\begin{description}
\item{\tt VIz\_On}  Write field data to VTK file
\item{\tt VIz\_Off} Do not write field data to VTK file.
\end{description}
%
In the \verb|[Monitor_flag]|, output in the monitoring data is defined by
%
\begin{description}
\item{\tt Monitor\_On}  Write spectrum into monitoring data
\item{\tt Monitor\_Off} Do not write spectrum into monitoring data
\end{description}
%
Supported field in the present version is listed in Table from \ref{table:fields} to \ref{table:energy_flux_sym} 
%
\begin{table}[htp]
\caption{List of field name}
\begin{center}
\begin{tabular}{|c|c|c|}
\hline
\tt [Name] & field name & Description \\ \hline \hline
\tt velocity &    Velocity &  $\bvec{u}$ \\
\tt vorticity &   Vorticity & $\bvec{\omega} = \nabla \times \bvec{u} $ \\
\tt pressure &    Pressure & $P$ \\
\hline
\tt temperature & Temperature & $T$ \\
\tt perturbation\_temp & Perturbation of temperature
& $\Theta = T - T_{0}$ \\
\tt heat\_source & Heat source
& $q_{T}$ \\
\hline
\tt composition & Composition variation & $C$ \\
\tt composition\_source & Composition source & $q_{C}$ \\
\hline
\tt magnetic\_field &  Magnetic field  & $\bvec{B}$ \\
\tt current\_density & Current density & $\bvec{J} = \nabla \times \bvec{B} $ \\
\tt electric\_field & Electric field & $\bvec{E} = \sigma \left(\bvec{J} - \bvec{u} \times \bvec{B}\right) $ \\
\tt truncated\_magnetic\_field & Truncated Magnetic field at $Lt$ & $\sum_{l=1}^{Lt} \bvec{B}_{l}^{m}$ \\
 &  See \hyperref[href_t:crustal_filtering_ctl]{\tt truncation\_degree\_ctl} &  \\
\hline \hline
\tt viscous\_diffusion & Viscous diffusion
& $-\nu \nabla \times \nabla \times \bvec{u}$ \\
\tt inertia & Inertia term &  $ \bvec{\omega} \times \bvec{u} $ \\
\tt buoyancy                   & Thermal buoyancy &  $ -\alpha_{T} T \bvec{g}  $ \\
\tt composite\_buoyancy & Compositional buoyancy &  $ -\alpha_{C} C\bvec{g}  $\\
\tt Lorentz\_force & Lorentz force &  $ \bvec{J} \times \bvec{B} $ \\
\tt Coriolis\_force & Coriolis force &  $ -2 \Omega \hat{z} \times \bvec{u} $ \\
\tt pressure\_gradient & Pressure gradient &  $  - \nabla P  $ \\
\tt rest\_of\_geostrophic & Rest of geostrophic balance &  $ - \nabla P - 2 \Omega \hat{z} \times \bvec{u} $ \\
\hline
\tt thermal\_diffusion & Termal diffusion & $ \kappa_{T} \nabla^{2} T $ \\
\tt grad\_temp & Temperature gradient & $ \nabla T$ \\
\tt heat\_flux & Advective heat flux & $ \bvec{u} T$ \\
\tt heat\_advect & Heat advection & $ \bvec{u} \cdot \nabla T = \nabla \cdot \left(  \bvec{u} T \right) $ \\
\hline
\tt composition\_diffusion & Compositional diffusion & $ \kappa_{C} \nabla^{2} C $ \\
\tt grad\_composition & Composition gradient & $ \nabla C$ \\
\tt composite\_flux & Advective composition flux & $ \bvec{u} C$ \\
\tt composition\_advect & Compositional advection & $ \bvec{u} \cdot \nabla C = \nabla \cdot \left(  \bvec{u} C \right) $ \\
\hline
\tt magnetic\_diffusion & Magnetic diffusion
& $-\eta \nabla \times \nabla \times \bvec{B}$ \\
\tt vecp\_induction & Induction for the vector potential &  $ \bvec{u} \times \bvec{B} $ \\
\tt magnetic\_induction & Magnetic induction &  $ \nabla \times \left(\bvec{u} \times \bvec{B}\right) $ \\
\tt poynting\_flux & Poynting flux &  $ \bvec{E} \times \bvec{B} $ \\
\hline
\end{tabular}
\end{center}
\label{table:fields}
\end{table}
%
%
\begin{table}[htp]
\caption{List of field name (Continued)}
\begin{center}
\begin{tabular}{|c|c|c|}
\hline
\tt [Name] & field name & Description \\ \hline \hline
\tt rot\_inertia & Curl of inertia &  $ \nabla \times \left(\bvec{\omega} \times \bvec{u}\right) $ \\
\tt rot\_Lorentz\_force & Curl of Lorentz force &  $ \nabla \times \left(\bvec{J} \times \bvec{B}\right) $ \\
\tt rot\_Coriolis\_force & Curl of Coriolis force &  $ -2 \Omega \nabla \times \left(\hat{z} \times \bvec{u} \right) $ \\
\tt rot\_buoyancy                   & Curl of thermal buoyancy &  $ - \nabla \times \left(\alpha_{T} T \bvec{g}\right)  $ \\
\tt rot\_composite\_buoyancy & Curl of compositional buoyancy &  $ - \nabla \times \left(\alpha_{C} C\bvec{g}\right)  $\\
\hline
\tt Lorentz\_work & Work of Lorentz force
 & $\bvec{u}\cdot \left( \bvec{J} \times \bvec{B} \right) $ \\ 
\tt work\_against\_Lorentz & Work against Lorentz force
 & $- \bvec{u}\cdot \left( \bvec{J} \times \bvec{B} \right) $ \\ 
\tt buoyancy\_flux & Thermal buoyancy flux & $ -\alpha_{T} T \bvec{g} \cdot \bvec{u} $ \\
\tt composite\_buoyancy\_flux & Compositional buoyancy flux & $ -\alpha_{c} C \bvec{g} \cdot \bvec{u} $ \\
\tt magnetic\_ene\_generation & Energy production by magnetic induction
 & $  \bvec{B} \cdot \left( \bvec{u} \times \bvec{B} \right) $ \\ 
\hline
\tt kinetic\_helicity & Kinetic helicity & $  \bvec{u} \cdot \bvec{\omega} $ \\
\tt current\_helicity & Current helicity & $  \bvec{B} \cdot \bvec{J} $ \\
\tt cross\_helicity & Cross helicity$^{*}$ & $  \bvec{u} \cdot \bvec{B} $ \\
\hline
\end{tabular}
\end{center}
*: Magnetic helicity $\bvec{A} \cdot \bvec{B} $ is not implimented.
\label{table:fields2}
\end{table}
%
\begin{table}[htp]
\caption{List of field names decomposed by equatorial symmetry}
\begin{center}
\begin{tabular}{|cc|cc|}
\hline
\multicolumn{2}{|c|}{Symmetric} & \multicolumn{2}{c|}{Anti-symmetric} \\
 {\tt [Name]}  & expression  & {\tt [Name]}  &  expression \\ \hline \hline
\tt sym\_velocity &  $\bvec{u}_{sym}$ &  \tt asym\_velocity &  $\bvec{u}_{asym}$  \\
\tt sym\_vorticity & $\bvec{\omega}_{sym} = \nabla \times \bvec{u}_{asym} $
     & \tt asym\_vorticity & $\bvec{\omega}_{asym} = \nabla \times \bvec{u}_{sym} $ \\
\tt sym\_pressure  & $P_{sym}$  & \tt asym\_pressure  & $P_{a}$ \\ \hline
\tt sym\_temperature & $T_{sym}$ & \tt asym\_temperature  & $T_{asym}$ \\
\tt sym\_composition & $C_{sym}$ & \tt asym\_composition & $C_{asym}$ \\ \hline
\tt sym\_magnetic\_field & $\bvec{B}_{sym}$ & \tt asym\_magnetic\_field  & $\bvec{B}_{asym}$ \\
\tt sym\_current\_density & $\bvec{J}_{sym} = \nabla \times \bvec{B}_{asym} $
     & \tt asym\_current\_density  & $\bvec{J}_{asym} = \nabla \times \bvec{B}_{sym} $ \\ \hline
\end{tabular}
\end{center}
\label{table:fields_sym}
\end{table}
%
%
\begin{table}[htp]
\caption{List of force and nonlinear term names decomposed by equatorial symmetry}
\begin{center}
\begin{tabular}{|c|c|}
\hline
{\tt [Name]} & expression  \\ \hline
\tt sym\_thermal\_buoyancy &  $ -\alpha_{T} T_{sym} \bvec{g}  $ \\
\tt asym\_thermal\_buoyancy &  $ -\alpha_{T} T_{asym} \bvec{g}  $ \\ \hline
\tt sym\_composite\_buoyancy &  $ -\alpha_{C} C_{sym} \bvec{g}  $ \\
\tt asym\_composite\_buoyancy &  $ -\alpha_{C} C_{asym} \bvec{g}  $ \\ \hline
%
\tt wsym\_x\_usym  &  $ \bvec{\omega}_{sym} \times \bvec{u}_{sym} $ \\
\tt wasym\_x\_uasym  &  $ \bvec{\omega}_{asym} \times \bvec{u}_{asym} $ \\
\tt wsym\_x\_uasym  &  $ \bvec{\omega}_{sym} \times \bvec{u}_{asym} $ \\
\tt wasym\_x\_usym  &  $ \bvec{\omega}_{asym} \times \bvec{u}_{sym} $ \\ \hline
%
\tt Jsym\_x\_Bsym  &  $ \bvec{J}_{sym} \times \bvec{B}_{sym} $ \\
\tt Jasym\_x\_Basym  &  $ \bvec{J}_{asym} \times \bvec{B}_{asym} $ \\
\tt Jsym\_x\_Basym  &  $ \bvec{J}_{sym} \times \bvec{B}_{asym} $ \\
\tt Jasym\_x\_Bsym  &  $ \bvec{J}_{asym} \times \bvec{B}_{sym} $ \\ \hline
%
\tt usym\_x\_Bsym  &  $ \bvec{u}_{sym} \times \bvec{B}_{sym} $ \\
\tt uasym\_x\_Basym  &  $ \bvec{u}_{asym} \times \bvec{B}_{asym} $ \\
\tt usym\_x\_Basym  &  $ \bvec{u}_{sym} \times \bvec{B}_{asym} $ \\
\tt uasym\_x\_Bsym  &  $ \bvec{u}_{asym} \times \bvec{B}_{sym} $ \\ \hline
\end{tabular}
\end{center}
\label{table:fields_sym2}
\end{table}
%
%
\begin{table}[htp]
\caption{List of energy flux names decomposed by equatorial symmetry}
\begin{center}
\begin{tabular}{|c|c|}
\hline
{\tt [Name]} & expression  \\ \hline
\tt sym\_buoyancy\_flux &  $ - \bvec{u}_{sym}  \cdot  \alpha_{T} T_{sym} \bvec{g}  $ \\
\tt asym\_buoyancy\_flux  &  $ - \bvec{u}_{asym}  \cdot  \alpha_{T} T_{asym} \bvec{g}  $ \\ \hline
% \tt sym\_composite\_buoyancy &  $ -\alpha_{C}  \cdot   C_{sym} \bvec{g}  $ \\
% \tt asym\_composite\_buoyancy &  $ -\alpha_{C}  \cdot   C_{asym} \bvec{g}  $ \\ \hline
%
\tt -ua\_d\_ws\_x\_us &  $  \bvec{u}_{asym} \cdot \left( \bvec{\omega}_{sym} \times \bvec{u}_{sym} \right)$ \\
\tt -ua\_d\_wa\_x\_ua  &  $ \bvec{u}_{asym} \cdot  \left( \bvec{\omega}_{asym} \times \bvec{u}_{asym} \right)$ \\
\tt -us\_d\_ws\_x\_ua  &  $ \bvec{u}_{sym} \cdot  \left( \bvec{\omega}_{sym} \times \bvec{u}_{asym} \right)$ \\
\tt -us\_d\_wa\_x\_us &  $ \bvec{u}_{sym} \cdot  \left( \bvec{\omega}_{asym} \times \bvec{u}_{sym} \right)$ \\ \hline
%
\tt ua\_d\_js\_x\_bs  &  $ \bvec{u}_{asym} \cdot \left(\bvec{J}_{sym} \times \bvec{B}_{sym} \right) $ \\
\tt ua\_d\_ja\_x\_ba  &  $ \bvec{u}_{asym}  \cdot  \left(\bvec{J}_{asym} \times \bvec{B}_{asym} \right) $ \\
\tt us\_d\_js\_x\_ba  &  $ \bvec{u}_{sym}  \cdot  \left(\bvec{J}_{sym} \times \bvec{B}_{asym} \right) $ \\
\tt us\_d\_ja\_x\_bs  &  $ \bvec{u}_{sym}  \cdot  \left(\bvec{J}_{asym} \times \bvec{B}_{sym} \right) $ \\ \hline
%
% \tt usym\_x\_Bsym  &  $ \bvec{u}_{sym} \times \bvec{B}_{sym} $ \\
% \tt uasym\_x\_Basym  &  $ \bvec{u}_{asym} \times \bvec{B}_{asym} $ \\
% \tt usym\_x\_Basym  &  $ \bvec{u}_{sym} \times \bvec{B}_{asym} $ \\
% \tt uasym\_x\_Bsym  &  $ \bvec{u}_{asym} \times \bvec{B}_{sym} $ \\ \hline
\end{tabular}
\end{center}
\label{table:energy_flux_sym}
\end{table}
%
%

\subsection{\tt time\_evolution\_ctl}
\label{href_t:time_evolution_ctl}
Fields for time evolution are defined in this block. \\
\hyperref[href_i:time_evolution_ctl]{(Back to {\tt control\_MHD})}

\paragraph{\tt array time\_evo\_ctl}
\label{href_t:time_evo_ctl}
\verb|[Field]| \\
Fields name for time evolution are listed in this array in \verb|[Field]| by text.
Available fields are listed in Table \ref{table:evolution_field}.
%
\begin{table}[htp]
\caption{List of field name for time evolution}
\begin{center}
\begin{tabular}{|c|c|c|}
\hline
 label & field name & Description \\ \hline
\verb|velocity| &    Velocity &  \bvec{u} \\
\verb|temperature| & Temperature & $T$ \\
\verb|composition| & Composition variation & $C$ \\
\verb|magnetic_field| &  Magnetic field  & $\bvec{B}$ \\ \hline
\end{tabular}
\end{center}
\label{table:evolution_field}
\end{table}

\subsection{\tt boundary\_condition}
\label{href_t:boundary_condition}
Boundary condition are defined in this block. \\
\hyperref[href_i:boundary_condition]{(Back to {\tt control\_MHD})}

\paragraph{\tt array bc\_temperature}
\label{href_t:bc_temperature}
\verb|[Group]  [Type]  [Value]| \\
Boundary conditions for temperature are defined by this array. Position of boundary is defined in \verb|[Group]| column by {\tt ICB} or {\tt CMB}. The following type of boundary conditions are available for temperature in \verb|[Type]| column.
%
\begin{description}
\item{\tt fixed}			Fixed homogeneous temperature on the boundary. The fixed value is defined in \verb|[Value]| by real.
\item{\tt fixed\_file}			Fixed temperature defined by external file. \verb|[Value]| in this line is ignored. See section \ref{sec:boundary_file}.
\item{\tt fixed\_flux}	Fixed homogeneous heat flux on the boundary. The value is defined in \verb|[Value]| by real. Positive value indicates outward flux from fluid shell. ({\it e.g.} Flux to center at ICB and Flux to mantle at CMB are positive.)
\item{\tt fixed\_flux\_file}			Fixed heat flux defined by external file. \verb|[Value]| in this line is ignored.  See section \ref{sec:boundary_file}.
\end{description}
%

\paragraph{\tt array bc\_velocity}
\label{href_t:bc_velocity}
\verb|[Group]  [Type]  [Value]| \\
Boundary conditions for velocity are defined by this array. Position of boundary is defined in \verb|[Group]| by {\tt ICB} or {\tt CMB}. The following boundary conditions are available for velocity in \verb|[Type]| column.
%
\begin{description}
\item{\tt non\_slip\_sph}	Non-slip boundary is applied to the boundary defined in \verb|[Group]|. Real value is required in \verb|[Value]|, but they value is not used in the program.
\item{\tt free\_slip\_sph}	Free-slip boundary is applied to the boundary defined in \verb|[Group]|. Real value is required in \verb|[Value]|, but they value is not used in the program.
\item{\tt rot\_inner\_core} If this condition is set, inner core ($r < r_{i}$) rotation is solved by using viscous torque and Lorentz torque. This boundary condition can be used for {\tt ICB}, and grid is filled to center. Real value is required in \verb|[Value]|, but they value is not used in the program.

\item{\tt rot\_x} Set constant rotation around $x$-axis in \verb|[Value]| by real. Rotation vector can be defined with {\tt rot\_y} and {\tt rot\_z}.
\item{\tt rot\_y} Set constant rotation around $y$-axis in \verb|[Value]| by real. Rotation vector can be defined with {\tt rot\_z} and {\tt rot\_x}.
\item{\tt rot\_z} Set constant rotation around $z$-axis in \verb|[Value]| by real. Rotation vector can be defined with {\tt rot\_x} and {\tt rot\_y}.
\end{description}
%

\paragraph{\tt array bc\_magnetic\_field}
\label{href_t:bc_magnetic_field}
\verb|[Group]  [Type]  [Value]| \\
Boundary conditions for magnetic field are defined by this array. Position of boundary is defined in \verb|[Group]| by {\tt to\_Center}, {\tt ICB}, or {\tt CMB}. The following boundary conditions are available for magnetic field in \verb|[Type]| column.
%
\begin{description}
\item{\tt insulator}	Magnetic field is connected to potential field at boundary defined in [Group]. real value is required at \verb|[Value]|, but they value is not used in the program.
\item{\tt sph\_to\_center}	 If this condition is set, magnetic field in conductive inner core ($r < r_{i}$) is solved. This boundary condition can be used for {\tt ICB}, and grid is filled to center. The value at \verb|[Value]| does not used.
\item{\tt pseudo\_vacuum}    Magetic field has only radial componenet at the specified boundary.
\end{description}
%

\paragraph{\tt array bc\_composition}
\label{href_t:bc_composition}
\verb|[Group]  [Type]  [Value]| \\
Boundary conditions for composition variation are defined by this array. Position of boundary is defined in \verb|[Group]| by {\tt ICB} or {\tt CMB}. The following boundary conditions are available for composition variation in \verb|[Type]| column.
%
\begin{description}
\item{\tt fixed}			Fixed homogeneous composition on the boundary. The fixed value is defined in \verb|[Value]| by real.
\item{\tt fixed\_file}			Fixed composition defined by external file. \verb|[Value]| in this line is ignored. See section \ref{sec:boundary_file}.
\item{\tt fixed\_flux}	Fixed homogeneous compositional flux on the boundary. The value is defined in \verb|[Value]| by real. Positive value indicates outward flux from fluid shell. ({\it e.g.} Flux to center at ICB and Flux to mantle at CMB are positive.)
\item{\tt fixed\_flux\_file}			Fixed compositional flux defined by external file. \verb|[Value]| in this line is ignored. See section \ref{sec:boundary_file}.
\end{description}
%

\subsection{\tt forces\_define}
\label{href_t:forces_define}
Forces for the momentum equation are defined in this block. \\
\hyperref[href_i:forces_define]{(Back to {\tt control\_MHD})}

\paragraph{\tt array force\_ctl}
\label{href_t:force_ctl}
\verb|[Force]| \\
Name of forces for momentum equation are listed in \verb|[Force]| by text.
The following fields are available.
%
\begin{table}[htp]
\caption{List of force}
\begin{center}
\begin{tabular}{|c|c|c|}
\hline
 Label & Field name & Equation \\ \hline
\verb|Coriolis| & Coriolis force & $-2\Omega \hat{z} \times \bvec{u} $ \\
\verb|Lorentz| & Lorentz force &  $\bvec{J} \times \bvec{B} $ \\
\verb|gravity| & Thermal buoyancy & $-\alpha_{T} T \bvec{g}$ \\
\verb|Composite_gravity| & Compositional buoyancy  & $-\alpha_{C} C \bvec{g}$\\ \hline
\end{tabular}
\end{center}
\label{table:forces}
\end{table}
%

\subsection{\tt dimensionless\_ctl}
\label{href_t:dimensionless_ctl}
Dimensionless numbers are defined in this block. \\
\hyperref[href_i:dimensionless_ctl]{(Back to {\tt control\_MHD})}

\paragraph{\tt array dimless\_ctl}
\label{href_t:dimless_ctl}
\verb|[Name] [Value]| \\
Dimensionless nummbers are defined in this array. The name is defined in \verb|[Name]| by text, and value is defined in \verb|[Value]| by real. These name of the dimensionless numbers are used to construct coefficients for each terms in governing equations. The following names can not be used because of reserved name in the program.
%
\begin{table}[htp]
\caption{List of reserved name of dimensionless numbers}
\begin{center}
\begin{tabular}{|c|c|c|}
\hline
 label & field name & value \\ \hline
\verb|Zero| & zero & 0.0 \\
\verb|One| &  one &  1.0 \\
\verb|Two| &  two &  2.0 \\
\verb|Radial_35| & Ratio of outer core thickness to whole core & $0.65 = 1 - 0.35$ \\ \hline
\end{tabular}
\end{center}
\label{table:reserved_params}
\end{table}
%

\subsection{\tt coefficients\_ctl}
\label{href_t:coefficients_ctl}
Coefficients of each term in governing equations are defined in this block.
Each coefficients are defined by list of name of dimensionless number \verb|[Name]| and its power \verb|[Power]|. For example, coefficient for Coriolis term for the dynamo benchmark $ 2E^{-1}$ is defined as
%
\begin{verbatim}
        array coef_4_Coriolis_ctl   2
          coef_4_Coriolis_ctl       Two            1.0
          coef_4_Coriolis_ctl       Ekman_number  -1.0
        end array coef_4_Coriolis_ctl
\end{verbatim}
%
\hyperref[href_i:coefficients_ctl]{(Back to {\tt control\_MHD})}

\subsubsection{\tt thermal}
\label{href_t:thermal}
Coefficients of each term in heat equation are defined in this block. \\
\hyperref[href_i:thermal]{(Back to {\tt control\_MHD})}

\paragraph{\tt coef\_4\_termal\_ctl}
\label{href_t:coef_4_termal_ctl}
\verb|[Name] [Power]| \\
Coefficient for evolution of temperature $\displaystyle \frac{\partial T}{\partial t}$ and advection of heat $\left(\bvec{u} \cdot \nabla \right) T$ is defined by this array.

\paragraph{\tt coef\_4\_t\_diffuse\_ctl}
\label{href_t:coef_4_t_diffuse_ctl}
\verb|[Name] [Power]| \\
Coefficient for thermal diffusion $\displaystyle \kappa_{T} \nabla^{2} T$ is defined by this array.

\paragraph{\tt coef\_4\_heat\_source\_ctll}
\label{href_t:coef_4_heat_source_ctl}
\verb|[Name] [Power]| \\
Coefficient for heat source $\displaystyle q_{T}$ is defined by this array.

\subsubsection{\tt momentum}
\label{href_t:momentum}
Coefficients of each term in momentum equation are defined in this block. \\
\hyperref[href_i:momentum]{(Back to {\tt control\_MHD})}

\paragraph{\tt coef\_4\_velocity\_ctl}
\label{href_t:coef_4_velocity_ctl}
\verb|[Name] [Power]| \\
Coefficient for evolution of velocity $\displaystyle \frac{\partial \bvec{u}}{\partial t}$ (or $\displaystyle \frac{\partial \bvec{\omega}}{\partial t}$ for the vorticity equation) and advection $-\bvec{\omega} \times \bvec{u}$ (or $- \nabla \times \left(\bvec{\omega} \times \bvec{u} \right)$ for the vorticity equation) is defined by this array.

\paragraph{\tt coef\_4\_press\_ctl}
\label{href_t:coef_4_press_ctl}
\verb|[Name] [Power]| \\
Coefficient for pressure gradient $-\nabla P$ is defined by this array. Pressure does not appear the vorticity equation which is used for the time integration. But this coefficient is used to evaluate pressure field.

\paragraph{\tt coef\_4\_v\_diffuse\_ctl}
\label{href_t:coef_4_v_diffuse_ctl}
\verb|[Name] [Power]| \\
Coefficient for viscous diffusion $- \nu \nabla \times \nabla \times \bvec{u}$ is defined by this array.

\paragraph{\tt coef\_4\_buoyancy\_ctl}
\label{href_t:coef_4_buoyancy_ctl}
\verb|[Name] [Power]| \\
Coefficient for buoyancy $- \alpha_{T} T \bvec{g}$ is defined by this array.

\paragraph{\tt coef\_4\_Coriolis\_ctl}
\label{href_t:coef_4_Coriolis_ctl}
\verb|[Name] [Power]| \\
Coefficient for Coriolis force $-2 \Omega \hat{z} \times \bvec{u}$ is defined by this array.

\paragraph{\tt coef\_4\_Lorentz\_ctl}
\label{href_t:coef_4_Lorentz_ctl}
\verb|[Name] [Power]| \\
Coefficient for Lorentz force $ \rho_{0}^{-1} \bvec{J} \times \bvec{B}$ is defined by this array.

\paragraph{\tt coef\_4\_composit\_buoyancy\_ctl}
\label{href_t:coef_4_composit_buoyancy_ctl}
\verb|[Name] [Power]| \\
Coefficient for compositional buoyancy $ -\alpha_{C} C \bvec{g}$ is defined by this array.

\subsubsection{\tt induction}
\label{href_t:induction}
Coefficients of each term in magnetic induction equation are defined in this block. \\
\hyperref[href_i:induction]{(Back to {\tt control\_MHD})}

\paragraph{\tt coef\_4\_magnetic\_ctl}
\label{href_t:coef_4_magnetic_ctl}
\verb|[Name] [Power]| \\
Coefficient for evolution of temperature $\displaystyle \frac{\partial \bvec{B}}{\partial t}$ is defined by this array.

\paragraph{\tt coef\_4\_m\_diffuse\_ctl}
\label{href_t:coef_4_m_diffuse_ctl}
\verb|[Name] [Power]| \\
Coefficient for magnetic diffusion $ -\eta \nabla \times \nabla \times \bvec{B}$ is defined by this array.

\paragraph{\tt coef\_4\_induction\_ctl}
\label{href_t:coef_4_induction_ctl}
\verb|[Name] [Power]| \\
Coefficient for magnetic induction $\nabla \times \left(\bvec{u} \times \bvec{B} \right)$ is defined by this array.

\subsubsection{\tt composition}
\label{href_t:composition}
Coefficients of each term in composition equation are defined in this block. \\
\hyperref[href_i:composition]{(Back to {\tt control\_MHD})}

\paragraph{\tt coef\_4\_composition\_ctl}
\label{href_t:coef_4_composition_ctl}
\verb|[Name] [Power]| \\
Coefficient for evolution of composition variation $\displaystyle \frac{\partial C}{\partial t}$ and advection of heat $\left(\bvec{u} \cdot \nabla \right) C$ is defined by this array.

\paragraph{\tt coef\_4\_c\_diffuse\_ctl}
\label{href_t:coef_4_c_diffuse_ctl}
\verb|[Name] [Power]| \\
Coefficient for compositional diffusion $\displaystyle \kappa_{C} \nabla^{2} C$ is defined by this array.

\paragraph{\tt coef\_4\_composition\_source\_ctll}
\label{href_t:coef_4_composition_source_ctl}
\verb|[Name] [Power]| \\
Coefficient for composition source $\displaystyle q_{C}$ is defined by this array.

% \subsection{\tt gravity\_define}
% \label{href_t:gravity_define}
% Gravity (buoyancy) vector is defined in this block \\
% \hyperref[href_i:gravity_define]{(Back to {\tt control\_MHD})} 
%
% \paragraph{\tt gravity\_type\_ctl}
% \label{href_t:gravity_type_ctl}
% \verb|[Direction]  [Value]| \\
% Gravity (buoyancy) type is defined by text. The following setting is available.
% \begin{description}
% \item{\tt radial} Gravity vector goes to center and is proportional to the radius $\bvec{g} = -\bvec{r}$. This model generally used to the geodyanmo simulations. 
% \item{\tt constant\_radial} Gravity vector goes to center and has constants amplitude  $\bvec{g} = -\bvec{r} / r$. This model generally used to the geodyanmo simulations. 
% \end{description}
%
% \subsection{\tt Coriolis\_define}
% \label{href_t:Coriolis_define}
% Rotation of the system for Coriolis force is defined in this block. \\
% \hyperref[href_i:Coriolis_define]{(Back to {\tt control\_MHD})}
%
% \paragraph{\tt array rotation\_vec}
% \label{href_t:rotation_vec}
% \verb|[Direction]  [Value]| \\
% Rotation vector of the system is defined by array. {\tt x}, {\tt y}, or {\tt z} is set in \verb|[Direction]|, and each component of the rotation vector is set in the \verb|[Value]| as real. In this program, the rotation vector does NOT normalized.

\subsection{\tt temperature\_define}
\label{href_t:temperature_define}
Reference of temperature $T_{0}$ is defined in this block. If reference of temperature is defined, perturbation of temperature $\Theta = T - T_{0}$ is used for time evolution and buoyancy. \\
\hyperref[href_i:temperature_define]{(Back to {\tt control\_MHD})}

\paragraph{\tt ref\_temp\_ctl}
\label{href_t:ref_temp_ctl}
\verb|[REFERENCE_TYPE]| \\
Type of reference temperature is defined by text. The following options are available for \verb|[REFERENCE_TYPE]|.
%
\begin{description}
\item{\tt none: }   \\
Reference of temperature is not defined. Temperature $T$ is used to time evolution and thermal buoyancy.
\item{\tt file: }      \\
Read reference temperature from data file defined by \hyperref[href_t:ref_field_file_name]{\tt [ref\_field\_file\_name]}
\item{\tt numerical\_solution: } \\
Reference temperature obtained from the given boundary condition and radial heat source by
\begin{eqnarray}
 0 = \nabla^{2} T_{0} + q_{0}
 \nonumber
\end{eqnarray}
%

\item{\tt spherical\_shell:} Reference of temperature is set by
\begin{eqnarray}
 T_{0} = \frac{1}{\left(r_{h}-r_{l} \right)} \left[
          r_{l}T_{l} - r_{h}T_{h} + \frac{r_{l} r_{h}}{r} \left(T_{h}-T_{l}\right) \right].
\nonumber
\end{eqnarray}
\item{\tt file} Reference temperature data is read from file defeind at {\tt [radial\_field\_file\_name]}. The reference temperature is interpolated into the radial grid in the simulation.
\end{description}
%
\paragraph{\tt ref\_field\_file\_name [File\_Name]}
\label{href_t:ref_field_file_name}
 [File\_Name] for the reference temperature is defined as text. 

\paragraph{\tt low\_temp\_ctl}
\label{href_t:low_temp_ctl}
Amplitude of low reference temperature $T_{l}$ and its radius $r_{l}$ (Generally $r_{l} = r_{o}$) are defined in this block.

\paragraph{\tt high\_temp\_ctl}
\label{href_t:high_temp_ctl}
Amplitude of high reference temperature $T_{h}$ and its radius $r_{h}$ (Generally $r_{h} = r_{i}$) are defined in this block.

\paragraph{\tt depth}
\label{href_t:depth}
\verb|[RADIUS]| \\
Radius for reference temperature is defined by real.

\paragraph{\tt temperature}
\label{href_t:temperature}
\verb|[TEMPERATURE]| \\
Temperature for reference temperature is defined by real.

\subsection{\tt composition\_define}
\label{href_t:composition_define}
Reference of light element $C_{0}$ is defined in this block. If reference of light element amount is defined, perturbation of temperature $\Theta_{C} = C - C_{0}$ is used for time evolution and buoyancy. \\
\hyperref[href_i:composition_define]{(Back to {\tt control\_MHD})}

\paragraph{\tt ref\_comp\_ctl}
\label{href_t:ref_comp_ctl}
\verb|[REFERENCE_TYPE]| \\
Type of reference temperature is defined by text. See  \hyperref[href_t:ref_temp_ctl]{\tt [ref\_temp\_ctl]} for the available options for \verb|[REFERENCE_TYPE]| .
%
\\paragraph{\tt low\_comp\_ctl}
\label{href_t:low_comp_ctl}
Amplitude of low reference composition $C_{l}$ and its radius $r_{l}$ (Generally $r_{l} = r_{o}$) are defined in this block.

\paragraph{\tt high\_comp\_ctl}
\label{href_t:high_comp_ctl}
Amplitude of high reference composition $C_{h}$ and its radius $r_{h}$ (Generally $r_{h} = r_{i}$) are defined in this block.

\paragraph{\tt composition}
\label{href_t:composition}
\verb|[COMPOSITION]| \\
Composition for the reference composition is defined by real.


\subsection{\tt time\_step\_ctl}
\label{href_t:time_step_ctl}
Time stepping parameters are defined in this block. \\
\hyperref[href_i:time_step_ctl]{(Back to {\tt control\_MHD})} \\
\hyperref[href_i:time_step_ctl2]{(Back to {\tt control\_assemble\_sph)}}

\paragraph{\tt elapsed\_time\_ctl}
\label{href_t:elapsed_time_ctl}
\verb|[ELAPSED_TIME]| \\
Elapsed (wall clock) time (second) for simulation \verb|[ELAPSED_TIME]| is defined by real. 
This parameter varies if end step \verb|[ISTEP_FINISH]| is defined to {\tt -1}. If simulation runs for given time, program output spectrum data  \verb|[rst_prefix].elaps.[process #].fst| immediately, and finish the simulation.

\paragraph{\tt i\_step\_init\_ctl}
\label{href_t:i_step_init_ctl}
\verb|[ISTEP_START]| \\
Start step of simulation \verb|[ISTEP_START]| is defined by integer. if \verb|[ISTEP_START]| is set to {\tt -1} and \verb|[INITIAL_TYPE]| is set to \verb|start_from_rst_file|, program read spectrum data file \verb|[rst_prefix].elaps.[process #].fst| and start the simulation.

\paragraph{\tt i\_step\_finish\_ctl}
\label{href_t:i_step_finish_ctl}
\verb|[ISTEP_FINISH]| \\
End step of simulation \verb|[ISTEP_FINISH]| is defined by integer. If this value is set to  {\tt -1}, simulation stops when elapsed time reaches to \verb|[ELAPSED_TIME]|.

\paragraph{\tt i\_step\_check\_ctl}
\label{href_t:i_step_check_ctl}
\verb|[ISTEP_MONITOR]| \\
Increment of time step for monitoring data \verb|[ISTEP_MONITOR]| is defined by integer.

\paragraph{\tt i\_step\_rst\_ctl}
\label{href_t:i_step_rst_ctl}
\verb|[ISTEP_RESTART]| \\
Increment of time step to output spectrum data for restarting \verb|[ISTEP_RESTART]| is defined by integer.

\paragraph{\tt i\_step\_field\_ctl}
\label{href_t:i_step_field_ctl}
\verb|[ISTEP_FIELD]| \\
Increment of time step to output field data for visualization \verb|[ISTEP_FIELD]| is defined by integer. If \verb|[ISTEP_FIELD]| is set to be 0, no field data are written.

\paragraph{\tt i\_step\_sectioning\_ctl}
\label{href_t:i_step_sectioning_ctl}
\verb|[ISTEP_SECTION]| \\
Increment of time step to output cross section data for visualization \verb|[ISTEP_SECTION]| is defined by integer. If \verb|[ISTEP_SECTION]| is set to be 0, no cross section data are written. If \verb|[ISTEP_SECTION]| is set in the block \hyperref[href_i:visual_control]{\tt visual\_control}, The value in {\tt visual\_control} is used.

\paragraph{\tt i\_step\_isosurface\_ctl}
\label{href_t:i_step_isosurface_ctl}
\verb|[ISTEP_ISOSURFACE]| \\
Increment of time step to output isosurface data for visualization \verb|[ISTEP_ISOSURFACE]| is defined by integer. If \verb|[ISTEP_ISOSURFACE]| is set to be 0, no isosurface data are written.If \verb|[ISTEP_ISOSURFACE]| is set in the block \hyperref[href_i:visual_control]{\tt visual\_control}, The value in {\tt visual\_control} is used.

\paragraph{\tt dt\_ctl}
\label{href_t:dt_ctl}
\verb|[DELTA_TIME]| \\
Length of time step $\Delta t$ is defined by real value.

\paragraph{\tt time\_init\_ctl}
\label{href_t:time_init_ctl}
\verb|[INITIAL_TIME]| \\
Initial time $t_{0}$ is defined by real value. This value is ignored if simulation starts from restart data.

\subsection{\tt new\_time\_step\_ctl}
\label{href_t:new_time_step_ctl}
Time stepping parameters to update initial data are defined in this block. Items in this block is the same as \hyperref[href_t:i_step_field_ctl]{\tt i\_step\_field\_ctl}.
\hyperref[href_i:new_time_step_ctl]{(Back to {\tt control\_assemble\_sph)}}


\subsection{\tt restart\_file\_ctl}
\label{href_t:restart_file_ctl}
Initial field for simulation is defined in this block.\\
\hyperref[href_t:restart_file_prefix]{(Back to {\tt control\_MHD})}

\paragraph{\tt rst\_ctl}
\label{href_t:rst_ctl}
\verb|[INITIAL_TYPE]| \\
Type of Initial field is defined by text. The following parameters are available for \verb|[INITIAL_TYPE]|.
%
\begin{description}
\item{\tt No\_data}  No initial data file. Small temperature perturbation and seed magnetic field are set as an initial field.
\item{\tt start\_from\_rst\_file} Initial field is read from spectrum data file. File prefix is defined by \hyperref[href_t:restart_file_prefix]{$\mbox{\tt restart\_file\_prefix}$}.
\item{\tt Dynamo\_benchmark\_0}   Generate initial field for dynamo benchmark case 0
\item{\tt Dynamo\_benchmark\_1}   Generate initial field for dynamo benchmark case 1
\item{\tt Dynamo\_benchmark\_2}   Generate initial field for dynamo benchmark case 2
\item{\tt Pseudo\_vacuum\_benchmark} Generate initial field for pseudo vacuum dynamo benchmark
\end{description}
%

\subsection{\tt time\_loop\_ctl}
\label{href_t:time_loop_ctl}
Time evolution scheme is defined in this block. \\
\hyperref[href_i:time_loop_ctl]{(Back to {\tt control\_MHD})}

\paragraph{\tt scheme\_ctl}
\label{href_t:scheme_ctl}
\verb|[EVOLUTION_SCHEME]| \\
Time evolution scheme is defined by text. Currently, Crank-Nicolson scheme is only available for diffusion terms.
%
\begin{description}
\item{\tt Crank\_Nicolson} Crank-Nicolson scheme for diffusion terms and second order Adams-Bashforth scheme the other terms.
% \item{\tt 2nd\_Adams\_Bashforth}  Second order Adams-Bashforth scheme
% \item{\tt explicit\_Euler} First order Euler scheme.
\end{description}
%

\paragraph{\tt coef\_implicit\_ctl}
\label{href_t:coef_implicit_ctl}
\verb|[COEF_INPLICIT]| \\
Coefficients for the implicit parts of the Crank-Nicolson scheme for all diffusion terms  \verb|[COEF_INPLICIT]| is defined by real.

\paragraph{\tt coef\_imp\_v\_ctl}
\label{href_t:coef_imp_v_ctl}
\verb|[COEF_INP_U]| \\
Coefficients for the implicit parts of the Crank-Nicolson scheme for viscous diffusion \verb|[COEF_INP_U]| is defined by real.

\paragraph{\tt coef\_imp\_t\_ctl}
\label{href_t:coef_imp_t_ctl}
\verb|[COEF_INP_T]| \\
Coefficients for the implicit parts of the Crank-Nicolson scheme for thermal diffusion \verb|[COEF_INP_T]| is defined by real.

\paragraph{\tt coef\_imp\_b\_ctl}
\label{href_t:coef_imp_b_ctl}
\verb|[COEF_INP_B]| \\
Coefficients for the implicit parts of the Crank-Nicolson scheme for magnetic diffusion \verb|[COEF_INP_B]| is defined by real.

\paragraph{\tt coef\_imp\_c\_ctl}
\label{href_t:coef_imp_c_ctl}
\verb|[COEF_INP_C]| \\
Coefficients for the implicit parts of the Crank-Nicolson scheme for compositional diffusion \verb|[COEF_INP_C]| is defined by real. 


\paragraph{\tt FFT\_library\_ctl}
\label{href_t:FFT_library_ctl}
\verb|[FFT_Name]| \\
FFT library name for Fourier transform is defined by text. The following libraries are available for \verb|[FFT_Name]|. 
If this flag is not defined, `FFTW` is chosen if FFTW library is included.
%
\begin{description}
\item{\tt FFTW}		Use FFTW
\item{\tt FFTPACK}	Use FFTPACK
% \item{\tt ISPACK}	Use ISPACK
% \item{\tt Search_fastest} Compare elapsed time of FFTW and FFTPACK at the initialization and choose faster one.
\end{description}
%

\paragraph{\tt Legendre\_trans\_loop\_ctl}
\label{href_t:Legendre_trans_loop_ctl}
\verb|[Leg_Loop]| \\
Loop configuration for Legendre transform is defined by text. The following settings are available for \verb|[Leg_Loop]|. 
If this flag is not defined, \verb|Symmetric_matmul_big| is chosen as a default value because \verb|Symmetric_matmul_big| is the fastest approarch in many platforms. In the all spherical transform, equatorial syymetry is taken into account.
%
\begin{description}
\item{\tt Symmetric_original_loop}	Set radial loop as the inner most loop for Legendre transform.
\item{\tt Symmetric_outer_radial_loop}	Set radial loop as the outmost loop for Legendre transform.
\item{\tt Symmetric_matmul}    Use Fortran90's intrinsic function for matrix-matrix products for each components.
\item{\tt Symmetric_matmul_big}   Use Fortran90's intrinsic function for matrix-matrix products. The matrix operation is combined for all radial and fielc components.
\item{\tt Symmetric_BLAS_big}    Use BLAS library for matrix-matrix products if BLAS library is linked. The matrix operation is combined for all radial and fielc components.
\item{\tt On_the_fly_Plm}   Evaluate Legendre polynomial in every Legendre transforms.
\item{\tt Search_fastest}	Compare elapsed time among above six approarch at the initialization and choose the fastest one.
\end{description}
%

%
\subsection{\tt sph\_monitor\_ctl}
\label{href_t:sph_monitor_ctl}
Monitoring data is defined in this block. Monitoring data output (mean square, average, Gauss coefficients, or specific components of spectrum data) are flagged by {\tt Monitor\_On} in \hyperref[href_t:nod_value_ctl]{ {\tt nod\_value\_ctl} array}. \\
\hyperref[href_i:sph_monitor_ctl]{(Back to {\tt control\_MHD})}

\paragraph{\tt volume\_average\_prefix}
\label{href_t:volume_average_prefix}
\verb|[vol_ave_prefix]| \\
File prefix for volume average data \verb|[vol_ave_prefix]| is defined by Text. Program add {\tt .dat} or {\tt .dat.gz} extension after this file prefix. If this file prefix is not defined, volume average data file is not generated. 

\paragraph{\tt volume\_pwr\_spectr\_prefix}
\label{href_t:volume_pwr_spectr_prefix}
\verb|[vol_pwr_prefix]| \\
File prefix for mean square spectrum data averaged over the fluid shell \verb|[vol_pwr_prefix]| is defined by Text. 

Spectrum as a function of degree $l$ is written in \verb|[vol_pwr_prefix]_l.dat|, spectrum as a function of order $m$ is written in \verb|[vol_pwr_prefix]_m.dat|, and spectrum as a function of $(l-m)$ is written in \verb|[vol_pwr_prefix]_lm.dat|. This prefix is also used for the file name of the volume mean square data as \verb|[vol_pwr_prefix]_s.dat|.
If this file prefix is not defined, volume spectrum data are not generated and volume mean square data is written as \verb|sph_pwr_volume_s.dat|.

\paragraph{\tt volume\_pwr\_spectr\_format}
\label{href_t:volume_pwr_spectr_format}
\verb|[file_format]| \\
File format for mean square spectrum data averaged over the fluid shell. The following formats are avaiable for \verb|[file_format]|. The default value is \verb|ASCII|. If the mean square data file exist, this setting is ignored and append data to the existing file.
%
\begin{description}
\item{\tt ASCII}   Text data.
\item{\tt gzip}    Text data is compressed by the gzip format.
\end{description}
%

\paragraph{\tt nusselt\_number\_prefix}
\label{href_t:nusselt_number_prefix}
\verb|[nusselt_number_prefix]| \\
File prefix for Nusselt number data at ICB and CMB \verb|[nusselt_number_prefix]| is defined by Text. Program add {\tt .dat} or {\tt .dat.gz} extension after this file prefix. If this file prefix is not defined, Nusselt number data file is not generated. \\
{\bf CAUTION: Nusselt number is not evaluated if heat source exsists.}

\paragraph{\tt nusselt\_number\_format}
\label{href_t:nusselt_number_format}
\verb|[file_format]| \\
File format for Nusselt number data \verb|[nusselt_number_prefix].dat|. If \verb|[file_format]| is \verb|gzip|, Nusselt number data is compressed by zlib.  If the Nusselt number data file exist, this setting is ignored and append data in the existing file.

%
\subsubsection{\tt volume\_spectrum\_ctl}
\label{href_t:volume_spectrum_ctl}
Volume average of power spectrum and mean square data between any radius range are defined in this block.

\paragraph{\tt degree\_spectra\_switch}
\label{href_t:degree_spectra_switch}
\verb|[ON/OFF]| \\
Switch to output the power spectrum data as a function of spherical harmonic degree $l$. Default value is {\tt ON}.

\paragraph{\tt order\_spectra\_switch}
\label{href_t:order_spectra_switch}
\verb|[ON/OFF]| \\
Switch to output the power spectrum data as a function of spherical harmonic order $m$. Default value is {\tt ON}.

\paragraph{\tt diff\_lm\_spectra\_switch}
\label{href_t:diff_lm_spectra_switch}
\verb|[ON/OFF]| \\
Switch to output the power spectrum data as a function of difference of spherical harmonic order from degree $l-m$. Default value is {\tt ON}.

\paragraph{\tt axisymmetric\_power\_switch}
\label{href_t:axisymmetric_power_switch}
\verb|[ON/OFF]| \\
Switch to output the mean square data for the axisymmetric component. Default value is {\tt ON}.

\paragraph{\tt Inner\_radius\_ctl}
\label{href_t:inner_radius_ctl}
\verb|[radius]| \\
Inner boundary of the volume average \verb|[radius]| is defined. The closest radial grid point is chosen as a inner boundary of averaging.

\paragraph{\tt outer\_radius\_ctl}
\label{href_t:outer_radius_ctl}
\verb|[radius]| \\
Outer boundary of the volume average \verb|[radius]| is defined. The closest radial grid point is chosen as the outer boundary of averaging.

%
\subsubsection{\tt layered\_spectrum\_ctl}
\label{href_t:layered_spectrum_ctl}
Sphere average of power spectrum and mean square data are defined in this block.

\paragraph{\tt layered\_pwr\_spectr\_prefix}
\label{href_t:layered_pwr_spectr_prefix}
\verb|[layer_pwr_prefix]| \\
File prefix for mean square spectrum data averaged over each sphere surface \verb|[layer_pwr_prefix]| is defined by Text.

Spectrum as a function of degree {l} is written in \verb|[layer_pwr_prefix]_l.dat|, spectrum as a function of order {m} is written in \verb|[layer_pwr_prefix]_m.dat|, and spectrum as a function of $(l-m)$ is written in \verb|[layer_pwr_prefix]_lm.dat|. If this file prefix is not defined, sphere averaged spectrum data are not generated. 

\paragraph{\tt layered\_pwr\_spectr\_format}
\label{href_t:layered_pwr_spectr_format}
\verb|[file_format]| \\
File format for mean square spectrum data averaged over the fluid shell. If \verb|[file_format]| is \verb|gzip|, the mean square and spectrum data are compressed by zlib. Otherwise, data file is written by text format. If the mean square data file exist, this setting is ignored and append data in the existing file.

\paragraph{\tt array spectr\_radius\_ctl}
\label{href_t:spectr_radius_ctl}
\verb|[Radius]|
List of radii \verb|[Radius]| to output power spectrum data by real value.
\paragraph{\tt array spectr\_layer\_ctl}
\label{href_t:spectr_layer_ctl}
\verb|[Layer #]|
List of radial grid point number \verb|[Layer #]| to output power spectrum data by integer. If this array nor array {\tt spectr\_radius\_ctl} is not defined, layered mean square data are written for all radial grid points.

%
\subsubsection{\tt gauss\_coefficient\_ctl}
\label{href_t:gauss_coefficient_ctl}
Gauss coefficients data at specified radius are defined in this block.

\paragraph{\tt gauss\_coefs\_prefix}
\label{href_t:gauss_coefs_prefix}
\verb|[gauss_coef_prefix]| \\
File prefix for Gauss coefficients \verb|[gauss_coef_prefix]| is defined by Text. Program add {\tt .dat} or {\tt .dat.gz} extension after this file prefix. If this file prefix is not defined, Gauss coefficients data are not generated. 

\paragraph{\tt gauss\_coefs\_format}
\label{href_t:gauss_coefs_format}
\verb|[file_format]| \\
File format for the Gauss coefficients data file. If \verb|[file_format]| is \verb|gzip|, volume mean square and spectrum data is compressed by zlib. Otherwise, data file is written by text format. If the Gauss coefficients data file exist, this setting is ignored and append data in the existing file.

\paragraph{\tt gauss\_coefs\_radius\_ctl}
\label{href_t:gauss_coefs_radius_ctl}
\verb|[gauss_coef_radius]| \\
Normalized radius to obtain Gauss coefficients \verb|[gauss_coef_radius]| is defined by real. Gauss coefficients are evaluated from the poloidal magnetic field at CMB by assuming electrically insulated mantle. Do not set \verb|[gauss_coef_radius]| less than the outer core radius $r_{o}$.

\paragraph{\tt array pick\_gauss\_coefs\_ctl}
\label{href_t:pick_gauss_coefs_ctl}
\verb|[Degree]  [Order]| \\
List of spherical harmonics mode $l$ and $m$ of Gauss coefficients to output. \verb|[Degree]| and \verb| [Order]| are defined by integer.

\paragraph{\tt array pick\_gauss\_coef\_degree\_ctl}
\label{href_t:pick_gauss_coef_degree_ctl}
\verb|[Degree]| \\
Degrees $l$ to output Gauss coefficients are listed in \verb|[Degree]| by integer. All Gauss coefficients with listed $l$ is output in file.

\paragraph{\tt array pick\_gauss\_coef\_order\_ctl}
\label{href_t:pick_gauss_coef_order_ctl}
\verb|[Order]| \\
Orders $m$ to output Gauss coefficients are listed in \verb|[Order]| by integer. All Gauss coefficients with listed order $m$ is output in file.

%
\subsubsection{\tt pickup\_spectr\_ctl}
\label{href_t:pickup_spectr_ctl}
Spherical harmonic coefficients data output is defined in this block.

\paragraph{\tt picked\_sph\_prefix}
\label{href_t:picked_sph_prefix}
\verb|[picked_sph_prefix]| \\
File prefix for picked spectrum data files \verb|[picked_sph_prefix]| is defined by Text. Program add {\tt [picked\_sph\_prefix]\_l[degree]\_m[order][c/s].dat} extension after this file prefix and save each mode of spherical harmonics coefficients data file. If this file prefix is not defined, picked spectrum data are not generated. Because data files are generated for each spherical harmonics mode, we recommend to save these files in a sub directory.

\paragraph{\tt picked\_sph\_format}
\label{href_t:picked_sph_format}
\verb|[file_format]| \\
File format for picked spectrum data files. If \verb|[file_format]| is \verb|gzip|, picked spectrum data files are compressed by zlib. Otherwise, data files are written by text format. If the picked spectrum data files exist, this setting is ignored and  data is appended in the existing file.

\paragraph{\tt array pick\_radius\_ctl}
\label{href_t:pick_radius_ctl}
\verb|[Layer #]|
List of radii \verb|[Radius]| to output picked spectrum data by integer.
\paragraph{\tt array pick\_layer\_ctl}
\label{href_t:pick_layer_ctl}
\verb|[Layer #]|
List of radial grid point number \verb|[Layer #]| to output picked spectrum data by integer. If this array nor array {\tt array pick\_radius\_ctl} is not defined, picked spectrum data are written for all radial grid points.

\paragraph{\tt array pick\_sph\_spectr\_ctl}
\label{href_t:pick_sph_spectr_ctl}
\verb|[Degree]  [Order]| \\
List of spherical harmonics mode $l$ and $m$ of spectrum data to output. \verb|[Degree]| and \verb| [Order]| are defined by integer.

\paragraph{\tt array pick\_sph\_degree\_ctl}
\label{href_t:pick_sph_degree_ctl}
\verb|[Degree]| \\
Degrees $l$ to output spectrum data are listed in \verb|[Degree]| by integer. All spectrum data with listed degree $l$ is output in file.

\paragraph{\tt array pick\_sph\_order\_ctl}
\label{href_t:pick_sph_order_ctl}
\verb|[Order]| \\
Order $m$ to output spectrum data are listed in \verb|[Order]| by integer. All spectrum data with listed order $m$ is output in file.

%
\subsubsection{\tt sph\_dipolarity\_ctl}
\label{href_t:sph_dipolarity_ctl}
Dipolrity data output is defined in this block.

\paragraph{\tt dipolarity\_file\_prefix}
\label{href_t:dipolarity_file_prefix}
\verb|[dipolarity_file_prefix]| \\
File prefix for dipolarity data files \verb|[dipolarity_file_prefix]| is defined by Text. Program add {\tt .dat} or {\tt .dat.gz} extension after this file prefix and save dipolarity data. If this file prefix is not defined, dipolarity data are not generated.

\paragraph{\tt dipolarity\_file\_format}
\label{href_t:dipolarity_file_format}
\verb|[file_format]| \\
File format for dipolarity data files. If \verb|[file_format]| is \verb|gzip|, dipolarity data files are compressed by zlib. Otherwise, the data file is written by text format. If the dipolrity data file exist, this setting is ignored and data is appended in the existing file.

\paragraph{\tt array dipolarity\_truncation\_ctl}
\label{href_t:dipolarity_truncation_ctl}
\verb|[Degree]| \\
Truncation degrees $l$ to evaluate dipolarity is defined in \verb|[Degree]| by integer. More than 1 truncations can be defined in this array. The dipolarity with the truncation degree of the simulation $L_{max}$ is automatically added in the dta output.
%

\subsubsection{\tt dynamo\_benchmark\_data\_ctl}
\label{href_t:dynamo_benchmark_data_ctl}
Parameters to generate dynamo benchmark data.

\paragraph{\tt dynamo\_benchmark\_file\_prefix}
\label{href_t:dynamo_benchmark_file_prefix}
\verb|[File\_Prefix]| \\
File prefix for dynamo benchmark data output.

\paragraph{\tt dynamo\_benchmark\_file\_format}
\label{href_t:dynamo_benchmark_file_format}
\verb|[ASCII or gzip]| \\
File format of the data files. {\tt ASCII} or {\tt gzip} are available.

\paragraph{\tt nphi\_mid\_eq\_ctl}
\label{href_t:nphi_mid_eq_ctl}
\verb|[Nphi_mid_equator]| \\
Number of grid points \verb|[Nphi_mid_equator]|in longitudinal direction to evaluate mid-depth of the shell in the equatorial plane for dynamo benchmark is defined as integer. If \verb|[Nphi_mid_equator]| is not defined or less than zero, \verb|[Nphi_mid_equator]| is set set number grid as the input spherical transform data. 
%

\subsubsection{\tt fields\_on\_circle\_ctl}
\label{href_t:fields_on_circle_ctl}
Parameters to generate data at along with circle

\paragraph{\tt field\_on\_circle\_prefix}
\label{href_t:field_on_circle_prefix}
\verb|[File\_Prefix]| \\
File prefix for field data on the circle as a function of the longitude.

\paragraph{\tt spectr\_on\_circle\_prefix}
\label{href_t:spectr_on_circle_prefix}
\verb|[File\_Prefix]| \\
File prefix for field data on the circle as a function of the longitude.

\paragraph{\tt field\_on\_circle\_format}
\label{href_t:field_on_circle_format}
\verb|[ASCII or gzip]| \\
File format of the data files. {\tt ASCII} or {\tt gzip} are available.

\paragraph{\tt pick\_circle\_coord\_ctl}
\label{href_t:pick_circle_coord_ctl}
\verb|[Coordinate]| \\
Coordinate system for veator fields are defeined by {\tt spherical} or {\tt cylindrical}.

\paragraph{\tt pick\_cylindrical\_radius\_ctl}
\label{href_t:pick_cylindrical_radius_ctl}
\verb|[S]| \\
cylinderical radius of the circle {\tt [S]} is defined as a real value.

\paragraph{\tt pick\_vertical\_position\_ctl}
\label{href_t:pick_vertical_position_ctl}
\verb|[Z]| \\
Vertical position of the circle {\tt [Z]} is defined as a real value.

%

\subsection{\tt visual\_control}
\label{href_t:visual_control}
Visualization modules are defined in this block. Parameters for cross sections and isosurfaces are defined in this block. \\
\hyperref[href_i:visual_control]{(Back to {\tt visual\_control})}

%
%
\subsection{\tt cross\_section\_ctl}
\label{href_t:cross_section_ctl}
Control parameters for cross sectioning are defined in this block. \\
\hyperref[href_i:cross_section_ctl]{(Back to {\tt cross\_section\_ctl)}}

\paragraph{\tt section\_file\_prefix}
\label{href_t:section_file_prefix}
\verb|[file_prefix]| \\
File prefix for cross section data is defined as character \verb|[file_prefix]|.

\paragraph{\tt psf\_output\_type}
\label{href_t:psf_output_type}
\verb|[file_format]| \\
File format for cross section data is defined as character \verb|[file_format]|. The following formats are available;
\begin{description}
\item{\tt VTK: }               VTK format
\item{\tt VTK\_gz: }           Compressed VTK format (Available if zlib library is linked)
\item{\tt PSF: }               Binary section data format
\item{\tt PSF\_gzip: }         Compressed Binary section data format (Available if zlib library is linked)
\end{description}

\subsubsection{\tt surface\_define}
\label{href_t:surface_define}
Each cross section is defined in this block. \\
\hyperref[href_i:cross_section_ctl]{(Back to {\tt cross\_section\_ctl)}} \\

\paragraph{\tt section\_method}
\label{href_t:section_method}
\verb|[METHOD]| \\
Method of the cross sectioning is defined as character \verb|[METHOD]|. Supported cross section is shown in Table \ref{table:surface_list}
%
\begin{table}[htp]
\caption{Supported cross sections}
\begin{center}
\begin{tabular}{|c|c|}
\hline
\verb|[METHOD]| & Surface type \\ \hline
\verb|equation| & Quadrature surface \\
% & $a x^2 + b y^2 + c z^2 + d y x + e z x + f x y + g x + h y + i z + j = 0$ \\
\verb|plane| & Plane surface \\
%& $a \left(x-x_{0} \right) + b \left(y-y_{0} \right) + c \left(z-z_{0} \right) = 0$ \\
\verb|sphere| & Sphere \\
%& $\left(x-x_{0} \right)^2 + \left(y-y_{0} \right)^2 + \left(z-z_{0} \right)^2 = r^2$  \\
\verb|ellipsoid| & Ellipsoid  \\
%& $\left(\frac{x-x_{0}}{a} \right)^2 + \left( \frac{y-y_{0}}{b} \right)^2 + \left( \frac{z-z_{0}}{c} \right)^2 = 1$ \\
\hline
\end{tabular}
\end{center}
\label{table:surface_list}
\end{table}
%

\paragraph{\tt coefs\_ctl}
\label{href_t:psf_coefs_ctl}
\verb|[TERM]	[COEFFICIENT]| \\
This array defines coefficients for a quadrature surface described by 
\begin{eqnarray*}
a x^2 + b y^2 + c z^2 + d y z + e z x + f x y + g x + h y + i z + j &=& 0.
\end{eqnarray*}
Each coefficient $a$ to $k$ are defined by the name of the term \verb|[TERM]| and real value \verb|[COEFFICIENT]| as shown in Table \ref{table:psf_coefs}. Undefined terms are set to be 0.
%
\begin{table}[htp]
\caption{List of coefficient labels for quadrature surface}
\begin{center}
\begin{tabular}{|c|c||c|c||c|c|}
\hline
\verb|[TERM]| & Defined value & \verb|[TERM]| & Defined value & \verb|[TERM]| & Defined value \\ \hline
\verb|x2| & $a$ & \verb|y2| & $b$  & \verb|z2| & $c$ \\
\verb|yz| & $d$ & \verb|zx| & $e$  & \verb|xy| & $f$ \\
\verb|x | & $g$ & \verb|y| & $h$  & \verb|z| & $i$ \\
\verb|const| & $j$ &  &   & &  \\ \hline
\end{tabular}
\end{center}
\label{table:psf_coefs}
\end{table}
%

\paragraph{\tt radius}
\label{href_t:psf_radius}
\verb|[SIZE]| \\
\verb|[SIZE]| defines radius $r$ for a sphere surface defined by 
\begin{eqnarray*}
\left(x-x_{0} \right)^2 + \left(y-y_{0} \right)^2 + \left(z-z_{0} \right)^2 = r^2. 
\end{eqnarray*}

\paragraph{\tt normal\_vector}
\label{href_t:psf_normal_vector}
\verb|[DIRECTION]	[COMPONENT]| \\
This array defines normal vector $(a, b, c)$ for a plane surface described by 
\begin{eqnarray*}
a \left(x-x_{0} \right) + b \left(y-y_{0} \right) + c \left(z-z_{0} \right) = 0. 
\end{eqnarray*}
Each component is defined by \verb|[DIRECTION]| and real value \verb|[COMPONENT]| as shown in Table \ref{table:psf_normal}.
%
\begin{table}[htp]
\caption{List of coefficient labels for vector}
\begin{center}
\begin{tabular}{|c|c|}
\hline
\verb|[DIRECTION]| & Defined value \\ \hline
\verb|x| & $a$ \\
\verb|y| & $b$ \\
\verb|z| & $c$ \\ \hline
\end{tabular}
\end{center}
\label{table:psf_normal}
\end{table}
%

\paragraph{\tt axial\_length}
\label{href_t:psf_axial_length}
\verb|[DIRECTION]	[COMPONENT]| \\
This array defines size $(a, b, c)$ of an ellipsoid surface described by 
\begin{eqnarray*}
\left(\frac{x-x_{0}}{a} \right)^2 + \left( \frac{y-y_{0}}{b} \right)^2 + \left( \frac{z-z_{0}}{c} \right)^2 = 1. 
\end{eqnarray*}
Each component is defined by \verb|[DIRECTION]| and real value \verb|[COMPONENT]| as shown in Table \ref{table:psf_normal}.
%

\paragraph{\tt center\_position}
\label{href_t:psf_center_position}
\verb|[DIRECTION]	[COMPONENT]| \\
Position of center $(x_{0}, y_{0}, z_{0})$ of sphere or ellipsoid is defined this array. Position on a plane surface $(x_{0}, y_{0}, z_{0})$ is also defined. Each component is defined by \verb|[DIRECTION]| and real value \verb|[COMPONENT]| as shown in Table \ref{table:psf_position}.
%
\begin{table}[htp]
\caption{List of coefficient labels for vector}
\begin{center}
\begin{tabular}{|c|c|}
\hline
\verb|[DIRECTION]| & Defined value \\ \hline
\verb|x| & $x_{0}$ \\
\verb|y| & $y_{0}$ \\
\verb|z| & $z_{0}$ \\ \hline
\end{tabular}
\end{center}
\label{table:psf_position}
\end{table}
%

\paragraph{\tt section\_area\_ctl}
\label{href_t:section_area_ctl}
Areas for the cross sectioning are defined in this array. The following groups can be defined in this block.
%
\begin{description}
	\item{\tt outer\_core} Outer core.
	\item{\tt inner\_core} Inner core (If exist).
	\item{\tt external} External of the core (If exist).
	\item{\tt all} Whole simulation domain.
\end{description}

%
\subsubsection{\tt output\_field\_define}
\label{href_t:output_field_define}
Field data on the cross section are defined in this block. \\
\hyperref[href_i:cross_section_ctl]{(Back to {\tt cross\_section\_ctl)}} \\

%
\paragraph{\tt output\_field}
\label{href_t:psf_output_field}
Field informations for cross section are defined in this array. Name of the output fields is defined by \verb|[FIELD]|, and component of the fields is defined by \verb|[COMPONENT]|. Labels of the field name are listed in Table \ref{table:fields}, and labels of the component are listed in Table \ref{table:components}. \\
%
\begin{table}[htp]
\caption{List of field type for cross sectioning and isosurface module}
\label{table:components}
\begin{center} 
\begin{tabular}{|c|c|}
\hline
 \verb|[COMPONENT]| & Field type  \\ \hline \hline
 \verb|scalar| & scalar field  \\ \hline
 \verb|vector| & Cartesian vector field \\ \hline
 \verb|x| & $x$-component  \\ \hline
 \verb|y| & $y$-component  \\ \hline
 \verb|z| & $z$-component  \\ \hline
 \verb|radial| & radial ($r$-) component  \\ \hline
 \verb|theta| & $\theta$-component  \\ \hline
 \verb|phi| & $\phi$-component  \\ \hline
 \verb|cylinder_r| & cylindrical radial ($s$-) component  \\ \hline
 \verb|magnitude| & magnitude of vector  \\ \hline
\end{tabular}
\end{center}
\end{table}
%
%


\subsection{\tt isosurface\_ctl}
\label{href_t:isosurface_ctl}
Control parameters for isosurfacing are defined in this block. \\
\hyperref[href_i:isosurface_ctl]{(Back to {\tt isosurface\_ctl)}}

%
%
\paragraph{\tt isosurface\_file\_prefix}
\label{href_t:isosurface_file_prefix}
\verb|[file_prefix]| \\
File prefix for isosurface data is defined as character \verb|[file_prefix]|.

\paragraph{\tt iso\_output\_type}
\label{href_t:iso_output_type}
File format for isosurface data is defined as character \verb|[file_format]|. The following formats are available;
\begin{description}
\item{\tt VTK: }               VTK format
\item{\tt VTK\_gz: }           Compressed VTK format (Available if zlib library is linked)
\item{\tt ISO: }               Binary isosurface data format
\item{\tt ISO\_gzip: }         Compressed Binary isosurface data format (Available if zlib library is linked)
\end{description}

\subsubsection{\tt isosurf\_define}
\label{href_t:isosurf_define}
Each isosurface is defined in this block. \\
\hyperref[href_i:isosurface_ctl]{(Back to {\tt isosurface\_ctl)}}

\paragraph{\tt isosurf\_field}
\label{href_t:isosurf_field}
Field name for isosurface is defined by \verb|[FIELD]|. Labels of the field name are listed in Table \ref{table:fields}. \\
%
\paragraph{\tt isosurf\_component}
\label{href_t:isosurf_component}
Component name for isosurface is defined by \verb|[COMPONENT]|. Labels of the component are listed in Table \ref{table:components}.

%
\paragraph{\tt isosurf\_value}
\label{href_t:isosurf_value}
Isosurface value is defined as real value \verb|VALUE|.

\paragraph{\tt isosurf\_area\_ctl}
\label{href_t:isosurf_area_ctl}
Areas for the isosurfacing are defined in this array. The same groups can be defined as \hyperref[href_t:psf_output_field]{\tt section\_area\_ctl}.

%
\subsubsection{\tt field\_on\_isosurf}
\label{href_t:field_on_isosurf}
Field data on the isosurface are defined in this block. \\
\hyperref[href_i:isosurface_ctl]{(Back to {\tt isosurface\_ctl)}}

%
\paragraph{\tt result\_type}
\label{href_t:result_type}
Output data type is defined by \verb|[TYPE]|. Following types can be defined:
%
\begin{description}
	\item{\tt constant} Constant value is set as a result field. The amplitude is set by \verb|result_value|.
	\item{\tt field} field data on the isosurface are written. Fields to be written are defined by \verb|output_field| array.
\end{description}

%
\paragraph{\tt result\_value}
\label{href_t:result_value}
Value in output data `[VALUE]` is defined as real value.


%
\paragraph{\tt output\_field}
\label{href_t:iso_output_field}
Field informations for cross section are defined in this array. Name of the output fields is defined by \verb|[FIELD]|, and component of the fields is defined by \verb|[COMPONENT]|. Labels of the field name are listed in Table \ref{table:fields}, and labels of the component are listed in Table \ref{table:components}. \\
%
%
\subsection{\tt output\_field\_file\_fmt\_ctl  [VTK\_format]}
\label{href_t:output_field_file_fmt_ctl}
File format of field data is defined as character \verb|[VTK_format]|. THe following formats are available.
%
\begin{description}
\item{\tt single\_HDF5: }  Merged HDF5 file (Available if HDF5 library is linked)
\item{\tt single\_VTK: }   Merged VTK file (Default)
\item{\tt VTK: }           Distributed VTK file
\item{\tt single\_VTK\_gz: }   Compressed merged VTK file (Available if zlib library is linked)
\item{\tt VTK\_gz: }           Compressed distributed VTK file (Available if zlib library is linked)
\end{description}

\subsection{\tt dynamo\_vizs\_control}
\label{href_t:dynamo_vizs_control}
Visualization for zonal mean, RMS, and truncated magnetic field are defined in this block. Parameters for cross section is set for zonal mean and RMS, and spherical harmonics degree of the truncated magnetic field is also defined here. \\
\hyperref[href_i:dynamo_vizs_control]{(Back to {\tt dynamo\_vizs\_control)}}

%
%
\paragraph{\tt zonal\_mean\_section\_ctl}
\label{href_t:zonal_mean_section_ctl}
Control parameters for cross section of the zonal mean field are defined in this block. This block has the same control items as \hyperref[href_i:cross_section_ctl]{\tt cross\_section\_ctl}. In the external file {\tt [zonal\_mean\_section\_control\_file]}, con trol block starts from {\tt cross\_section\_ctl}.


\paragraph{\tt zonal\_RMS\_section\_ctl}
\label{href_t:zonal_RMS_section_ctl}
Control parameters for cross section of the zonal RMS field are defined in this block. This block has the same control items as \hyperref[href_i:cross_section_ctl]{\tt cross\_section\_ctl}. In the external file {\tt [zonal\_RMS\_section\_control\_file]}, con trol block starts from {\tt cross\_section\_ctl}.

\paragraph{\tt crustal\_filtering\_ctl}
\label{href_t:crustal_filtering_ctl}
Set the truncation degree to make the truncated magnetic field by the crustal magnetic field. The spherical harmonics degree of the truncated magnetic field is defined in {\tt truncation\_degree\_ctl}. In the external file {\tt [zonal\_mean\_section\_control\_file]}, con trol block starts from {\tt cross\_section\_ctl}.

%

\subsection{\tt new\_data\_files\_def}
\label{href_t:new_data_files_def}
File names and number of processes for new domain decomposed data are defined in this block. \\
\hyperref[href_i:new_data_files_def]{(Back to {\tt control\_assemble\_sph)}}

\paragraph{\tt delete\_original\_data\_flag}
\label{href_t:delete_original_data_flag}
\verb|[delete_original_data_flag]| \\
If this flag set to \verb|YES|, original specter data is deleted at the end of program. 

\subsection{\tt new\_time\_step\_ctl}
\label{href_t:new_time_step_ctl}
Parameters to modify time step and time data in the new restart file. \\
\hyperref[href_i:new_time_step_ctl]{(Back to {\tt control\_assemble\_sph)}}

\paragraph{\tt magnetic\_field\_ratio\_ctl}
\label{href_t:i_step_init_ctl_a} 
\verb|[ISTEP_START]| \\
New time step \verb|[ISTEP_START]| for the restart file is defined by integer.

\paragraph{\tt i\_step\_rst\_ctl}
\label{href_t:i_step_rst_ctl_a} 
\verb|[ISTEP_RESTART]| \\
New step number of restrart file \verb|[ISTEP_RESTART]| is defined by integer.

\paragraph{\tt time\_init\_ctl}
\label{href_t:time_init_ctl_a} 
\verb|[INITIAL_TIME]| \\
New time data \verb|[INITIAL_TIME]| is defined by real.


\subsection{\tt newrst\_magne\_ctl}
\label{href_t:newrst_magne_ctl}
Parameters to modify magnetic field are defined in this block. \\
\hyperref[href_i:newrst_magne_ctl]{(Back to {\tt control\_assemble\_sph)}}

\paragraph{\tt magnetic\_field\_ratio\_ctl}
\label{href_t:magnetic_field_ratio_ctl} 
\verb|[ratio]| \\
Ratio of new magnetic field data to original magnetic field \verb|[ratio]| is defined by real.


\subsection{\tt time\_averaging\_sph\_monitor}
\label{href_t:time_averaging_sph_monitor}
Parameters for time averaging of monitor data files.

\paragraph{\tt start\_time\_ctl}
\label{href_t:tave_start_time_ctl} 
\verb|[TIME]| \\
Start  time \verb|[TIME]| for the restart file is defined by real.

\paragraph{\tt end\_time\_ctl}
\label{href_t:tave_end_time_ctl} 
\verb|[TIME]| \\
End  time \verb|[TIME]| for the restart file is defined by real.

\paragraph{\tt volume\_integrate\_prefix}
\label{href_t:volume_integrate_prefix} 
\verb|[File\_Prefix]| \\
File prefix  \verb|[File\_Prefix]|  for  volume integrated data is defined by text.

\paragraph{\tt volume\_sph\_spectr\_prefix}
\label{href_t:volume_sph_spectr_prefix} 
\verb|[File\_Prefix]| \\
File prefix  \verb|[File\_Prefix]|  for  volume integrated spectrum data is defined by text.

\paragraph{\tt sphere\_integrate\_prefix}
\label{href_t:sphere_integrate_prefix} 
\verb|[File\_Prefix]| \\
File prefix  \verb|[File\_Prefix]|  for sphere integrated data is defined by text.

\paragraph{\tt layer\_sph\_spectr\_prefix}
\label{href_t:layer_sph_spectr_prefix} 
\verb|[File\_Prefix]| \\
File prefix  \verb|[File\_Prefix]|  for  layered spectrum data is defined by text.

\paragraph{\tt picked\_sph\_prefix}
\label{href_t:picked_sph_prefix} 
\verb|[File\_Prefix]| \\
File prefix  \verb|[File\_Prefix]|  for  picked up spectrum data is defined by text.


